import{b as te,d as ie,f as ne}from"./chunk-O6JWBXPI.js";import{b as g,c as P,d as j,e as q,f as U,g as z,i as O,j as Y,k as $,l as H,o as X,q as Z,t as ee}from"./chunk-ODHERY6O.js";import{f as b,l as B,q as Q,r as oe}from"./chunk-UQ6H7UZN.js";import"./chunk-U3QUSVWF.js";import{a as K}from"./chunk-SJAHQ6V3.js";import{fa as J}from"./chunk-66N5ZWW3.js";import{h as _,j as L}from"./chunk-YUIZQQQA.js";import{$b as W,Ba as s,Bb as M,Gb as i,Hb as e,Ib as a,Mb as v,Ob as E,Pb as A,Xa as l,Zb as p,_b as V,a as I,b as F,bc as R,ca as c,cc as k,dc as G,gb as D,lb as N,ma as d,na as f,oc as y,wb as m,ya as T,yb as x,zc as C}from"./chunk-4YCFH6U6.js";function ue(u,r){u&1&&(i(0,"tr")(1,"th"),p(2,"#"),e(),i(3,"th",12),p(4,"\u10D0\u10DC\u10D2\u10D0\u10E0\u10D8\u10E8\u10D8\u10E1 \u10E2\u10D8\u10DE\u10D8"),e(),i(5,"th"),p(6,"\u10D5\u10D0\u10DA\u10E3\u10E2\u10D0"),e(),i(7,"th",12),p(8,"\u10D0\u10DC\u10D2\u10D0\u10E0\u10D8\u10E8\u10D8\u10E1 \u10E1\u10E2\u10D0\u10E2\u10E3\u10E1\u10D8"),e()())}function se(u,r){if(u&1&&(i(0,"tr",13)(1,"td"),p(2),e(),i(3,"td"),a(4,"p-select",14),e(),i(5,"td"),a(6,"p-select",15),e(),i(7,"td"),a(8,"p-select",16),e()()),u&2){let t=r.$implicit,o=r.rowIndex,n=A();m("formGroup",t),l(2),V(o+1),l(2),m("options",n.types()),l(2),m("options",n.currencies()),l(2),m("options",n.statuses())}}function me(u,r){if(u&1){let t=v();i(0,"tr")(1,"td")(2,"p-button",17),E("click",function(){d(t);let n=A();return f(n.onAddRow())}),e()(),i(3,"td"),a(4,"div",18),e(),i(5,"td"),a(6,"div",18),e(),i(7,"td"),a(8,"div",18),e(),i(9,"td"),a(10,"div",18),e(),i(11,"td"),a(12,"div",18),e()()}}var S=class u{_store=c(b);_notifier=c(Q);_fb=c(Y);_router=c(L);_route=c(_);currencies=s(te);statuses=s(ie);types=s(ne);clients=T();clientsSignal=s([]);selectedClient=s(void 0);formArray=s(this._fb.array([]));form=s(this._fb.group({rows:this.formArray()}));clientId=s(this._route.snapshot?.params.clientId);constructor(){C(()=>{let r=this.clients();setTimeout(()=>{this.clientsSignal.set(r)})}),C(()=>{this.selectedClient()&&this.resetFormArray()}),C(()=>{this.clientId()&&this.selectedClient.set(this.clientsSignal().find(r=>r.id==this.clientId()))})}onSubmit(){let r=this.formArray().getRawValue();if(this.formArray().invalid){this.formArray().controls.forEach(n=>n.markAllAsTouched()),this._notifier.sayError("\u10E4\u10DD\u10E0\u10DB\u10D0 \u10E8\u10D4\u10D5\u10E1\u10D4\u10D1\u10E3\u10DA\u10D8\u10D0 \u10EE\u10D0\u10E0\u10D5\u10D4\u10D6\u10D8\u10D7");return}let t=(r||[]).map(n=>({currencyId:n.currency?.value,statusId:n.status?.value,typeId:n.type?.value})),o={clientId:this.clientId()||this.selectedClient()?.id,accounts:t};this._store.dispatch(B(o))}goToBack(){this._router.navigate(["/"])}onAddRow(){this.formArray().push(this._fb.group({type:["",[g.required]],currency:["",[g.required]],status:["",[g.required]]}))}resetFormArray(){this.formArray.set(this._fb.array([]))}static \u0275fac=function(t){return new(t||u)};static \u0275cmp=D({type:u,selectors:[["app-account-form"]],inputs:{clients:[1,"clients"]},decls:15,vars:8,consts:[["table",""],["header",""],["body",""],["footer",""],[1,"p-mb-3"],["optionLabel","fullName","placeholder","\u10D0\u10D8\u10E0\u10E9\u10D8\u10D4 \u10D9\u10DA\u10D8\u10D4\u10DC\u10E2\u10D8",1,"w-full","md:w-80",3,"ngModelChange","disabled","options","ngModel"],[3,"ngSubmit","formGroup"],["styleClass","mt-3 border overflow-none",3,"value"],[1,"d-flex","w-100","align-items-center","mt-3"],[1,"d-flex","w-100","justify-content-end"],["type","button","label","\u10E3\u10D9\u10D0\u10DC","icon","pi pi-arrow-left","severity","secondary",1,"ms-3",3,"onClick"],["type","submit","severity","primary",1,"ms-3",3,"label"],[2,"width","20%"],[3,"formGroup"],["id","type","formControlName","type","optionLabel","name","placeholder","\u10D0\u10D8\u10E0\u10E9\u10D8\u10D4 \u10E2\u10D8\u10DE\u10D8",1,"w-full","md:w-40",3,"options"],["id","currency","formControlName","currency","optionLabel","name","placeholder","\u10D0\u10D8\u10E0\u10E9\u10D8\u10D4 \u10D5\u10D0\u10DA\u10E3\u10E2\u10D0",1,"w-full","md:w-40",3,"options"],["id","status","formControlName","status","optionLabel","name","placeholder","\u10D0\u10D8\u10E0\u10E9\u10D8\u10D4 \u10E1\u10E2\u10D0\u10E2\u10E3\u10E1\u10D8",1,"w-full","md:w-40",3,"options"],["type","button","icon","pi pi-plus","severity","primary",3,"click"],[1,"td-placeholder"]],template:function(t,o){if(t&1){let n=v();i(0,"p-card",4)(1,"p-select",5),G("ngModelChange",function(h){return d(n),k(o.selectedClient,h)||(o.selectedClient=h),f(h)}),e(),i(2,"form",6),E("ngSubmit",function(){return d(n),f(o.onSubmit())}),i(3,"p-table",7,0),N(5,ue,9,0,"ng-template",null,1,y)(7,se,9,5,"ng-template",null,2,y)(9,me,13,0,"ng-template",null,3,y),e(),i(11,"div",8)(12,"div",9)(13,"p-button",10),E("onClick",function(){return d(n),f(o.goToBack())}),e(),a(14,"p-button",11),e()()()()}if(t&2){let n;l(),m("disabled",o.clientId())("options",o.clientsSignal()),R("ngModel",o.selectedClient),l(),x("disabled",!((n=o.selectedClient())!=null&&n.id)),m("formGroup",o.form()),l(),m("value",o.formArray().controls),l(11),m("label","\u10E8\u10D4\u10DC\u10D0\u10EE\u10D5\u10D0")}},dependencies:[X,$,U,P,j,q,K,ee,Z,H,z,O,J],encapsulation:2})};var re=class u{_store=c(b);_route=c(_);clients=s(this._route.snapshot.data.clients);constructor(){this._store.dispatch(oe(null)),this.listenToClients()}listenToClients(){this._store.select("clients").subscribe(r=>{this.clients.set((r.data||[]).map(t=>F(I({},t),{fullName:`${t.name} ${t.lastName}`})).filter(t=>!t?.accountsId))})}static \u0275fac=function(t){return new(t||u)};static \u0275cmp=D({type:u,selectors:[["app-account-details"]],decls:6,vars:5,consts:[[1,"mt-3"],[1,"mb-3"],[1,"text-secondary","font-size-20","d-flex","align-items-center"],[3,"clients"]],template:function(t,o){t&1&&(i(0,"div",0)(1,"div",1)(2,"label",2),a(3,"i"),p(4),e()(),a(5,"app-account-form",3),e()),t&2&&(l(3),M("font-size-20 me-2 pi ","pi-user-plus",""),l(),W(" ","\u10D0\u10DC\u10D2\u10D0\u10E0\u10D8\u10E8(\u10D4\u10D1)\u10D8\u10E1 \u10D3\u10D0\u10DB\u10D0\u10E2\u10D4\u10D1\u10D0"," "),l(),m("clients",o.clients()))},dependencies:[S],encapsulation:2})};export{re as AccountDetailsComponent};
